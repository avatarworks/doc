鉴权认证机制
============================

接口说明
------------------------------------

黑镜开放平台的API以Restful的方式接入。按照接口详细开发文档进行集成开发即可。

- 授权认证，调用接口需要将 Authorization  信息放在 HTTP 请求头中；

- 接口统一为 UTF-8 编码；

- 接口支持 http 和 https；

- 请求方式为 POST 。

接口调用流程
------------------------------------

- 通过接口密钥基于hmac计算签名，将签名以及其他参数放在Http Request Header中，详见下方 `授权认证`_ 。
- 将音频或图片数据放在Http Request Body中，详见各接口的详细说明 。
- 向服务器端发送Http请求后，接收服务器端的返回结果，返回结果详见各接口的详细说明。

授权认证
------------------------------------

API 使用 hmac 签名，通过提取请求中的重要字段并使用用户或应用的密钥 AppKey/AppSecret 来构造签名，通过 HTTP 头部 Authorization: AW AppKey:Sign 发送到服务端，由服务端验证请求调用者的身份。

**变量说明:**

+------------------------+------------+-----------------------------------------------------------------------------+
| 变量名                 | 格式       | 说明                                                                        |
+------------------------+------------+-----------------------------------------------------------------------------+
| timestamp              |   string   |当前UTC时间戳,从1970-01-01 00:00:00到现在的秒数,认证时会校验timestamp是否为: |
|                        |            |当前UTC时间戳-900 < timestamp <当前UTC时间戳+900                             |
+------------------------+------------+-----------------------------------------------------------------------------+
| app_key                |   string   | 黑镜AI开放平台-> 应用管理中的 App Key                                       |
+------------------------+------------+-----------------------------------------------------------------------------+
| app_name               |   string   | 黑镜AI开放平台-> 应用管理中的 应用名                                        |
+------------------------+------------+-----------------------------------------------------------------------------+
| app_secret             |   string   | 黑镜AI开放平台-> 应用管理中的 App Secret                                    |
+------------------------+------------+-----------------------------------------------------------------------------+
| sign                   |   string   | 经过计算后得到的签名                                                        |
+------------------------+------------+-----------------------------------------------------------------------------+

**计算签名:**

::

  sign = base64_encode(timestamp + ":" +
  hash_hmac("sha256", timestamp + ":" + app_key + ":" + app_name, app_secret))

**添加HTTP头:**

::

  Authorization: "AW " + app_key + ":"  + sign
    注: "AW  " 字符AW跟随一个空格符


接口返回码
------------------------------------

- -10000  => 服务地址不存在

- -10001  => app_secret 有误

- -10002  => 参数有误或缺少

- -10003 => 签名已过期

- -10004 => 签名错误

- -10005 => 请求配额不足

- -10006 => 人脸重建失败

- -10007 => 相关文件不存在

- -10008 => 资源配置不存在

- -10009 => anim 生成出错

- -10010 => 检测到敏感图片
